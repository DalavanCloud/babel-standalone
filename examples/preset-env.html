<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>babel-env-standalone example</title>
</head>
<body>
  Input:
  <textarea id="input" style="width: 100%" rows="10">
  // Example ES2015 Code
  const a = 1;
  [].includes();
  Object.values({});
  </textarea>
  <code>targets.browsers:</code>
  <input id="browsers" style="width: 100%; font-size: 14px; padding: 3px; margin-bottom: 5px;" placeholder=">2%, chrome 58, last 1 ie version" value="ie 10">
  <span id="error" style="color: red;"></span>
  <code>useBuiltIns:</code>
  <select id="useBuiltIns" style="width: 100%; font-size: 14px; padding: 3px; margin-bottom: 5px;" placeholder=">2%, chrome 58, last 1 ie version">
    <option selected value="usage">usage</option>
    <option value="entry">entry</option>
    <option value="false">none</option>
  </select>

  Transformed code using Babel with babel-preset-env<strong id="version"></strong>:
  <pre id="output">Loading...</pre>

  <script src="../babel.js"></script>
  <script src="../packages/babel-env-standalone/babel-preset-env.js"></script>
  <script>
    console.log('Babel =', Babel);
    var inputEl = document.getElementById('input');
    var outputEl = document.getElementById('output');
    var browsers = document.getElementById('browsers');
    var useBuiltIns = document.getElementById('useBuiltIns');
    var errorEl = document.getElementById('error');

    var tm;
    function throttle(cb, delay) {
      return function () {
        clearTimeout(tm);
        tm = setTimeout(cb, delay);
      }
    }

    function transform() {
      try {
        errorEl.innerHTML = "";
        var useBuiltInsValue = useBuiltIns.value; 
        var useBuiltInsOption = !useBuiltInsValue || useBuiltInsValue === 'false' ? false : useBuiltInsValue;

        outputEl.innerHTML = Babel.transform(inputEl.value, {
          presets: [['env', {
            targets: { browsers: browsers.value },
            useBuiltIns: useBuiltInsOption,
            onPresetBuild: function(data) {
              console.log('Using plugins:\n', data.transformationsWithTargets);
              console.log('Using polyfills:\n', data.polyfillsWithTargets);
            }
          }]]
        }).code;
      } catch (ex) {
        errorEl.innerHTML = 'ERROR: ' + ex.message;
      }
    }

    inputEl.addEventListener('keyup', transform, false);
    browsers.addEventListener('keyup', throttle(transform, 500), false);
    useBuiltIns.addEventListener('change', transform, false);
    transform();
  </script>
</body>
</html>
